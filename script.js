!function(){document.getElementById("shopButton").onclick=function(){"none"==document.getElementById("shopMenu").style.display?(document.getElementById("shopMenu").style.display="block",document.getElementById("logofupdate").style.display="none",document.getElementById("settingContent").style.display="none",document.getElementById("taskContent").style.display="none"):document.getElementById("shopMenu").style.display="none"},document.getElementById("updateLogs").onclick=function(){"none"==document.getElementById("logofupdate").style.display?(document.getElementById("logofupdate").style.display="block",document.getElementById("shopMenu").style.display="none",document.getElementById("settingContent").style.display="none",document.getElementById("taskContent").style.display="none"):document.getElementById("logofupdate").style.display="none"};let e=["Server 1","Server 2"];localStorage.getItem("server")||localStorage.setItem("server","Server 1");let t=new WebSocket(atob({"Server 1":"d3NzOi8vZG9sb21pdGUtc2lsa2VuLWFsYmF0cm9zcy5nbGl0Y2gubWUvd2Vic29ja2V0","Server 2":"d3NzOi8vc2Fzc3ktZWxmaW4tdG9hc3Rlci5nbGl0Y2gubWUvd2Vic29ja2V0"}[localStorage.getItem("server")]));document.getElementById("serverid").addEventListener("change",()=>{localStorage.setItem("server",document.getElementById("serverid").value),location.href=location.href}),function t(){for(let n=0;n<e.length;n++){let o=e[n]==localStorage.getItem("server")?"selected":"";document.getElementById("serverid").innerHTML+=`<option id="${e[n]}" value="${e[n]}" ${o}>${e[n]}</option>`,n+1>=e.length||(document.getElementById("serverid").innerHTML+="<option></option>")}}(),Math.randInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var n,o=document.getElementById("canvas"),a=o.getContext("2d"),l=[],s={},i={scale:9e3},$=[],d=[],c=[];let r=[{name:"arrow",source:"projectiles/arrow.png",speed:20,scale:50},{name:"Cannon Ball",source:void 0,speed:10,scale:15},{name:"Musket Ball",source:void 0,speed:35,scale:7},{name:"Redball",source:void 0,speed:10,scale:30},{name:"Wand Spell",source:"projectiles/wand spell.png",speed:15,scale:50},],m=[{name:"Small Apple",desc:"Simple Healing Fruit that heals 10 HP",id:1,healAmount:10,onheal:5,cost:[0,0]},{name:"Medium Apple",desc:"More Complex Healing Fruit that heals 30 HP",id:2,healAmount:30,onheal:15,cost:[300,0]},{name:"Large Apple",desc:"This large apple can heal 50 HP and add 5 more maxhp",id:3,healAmount:50,maxheal:5,onheal:30,cost:[3e3,0]},{name:"Regen Potion",desc:"This potion heals you over time",id:4,healAmount:25,last:5e3,onheal:35,cost:[4e3,0]},{name:"Max Health Potion",desc:"This potion heals very little health but give you a lot of maxhealth",id:5,healAmount:25,maxheal:50,onheal:200,cost:[7e3,0]},{name:"Bundle of Apples",desc:"Restores a lot of health.",id:6,healAmount:200,onheal:50,cost:[8e3,0]},{name:"Golden Apples",desc:"Restores a lot of health and increases maxhp.",id:7,maxheal:20,healAmount:1e3,onheal:100,cost:[14e3,0]},{name:"God Apples",desc:"Restores a lot of health and increases maxhp.",id:7,maxheal:40,healAmount:2e3,last:3e3,onheal:500,cost:[5e4,0]},],p=[{name:"Pac Man hat",desc:"A hat made by OhMY: Increased Speed and Attack but you take increased dmg.",source:"hats/pac man hat.png",id:0,effect:{emp:!1,dmg:1,resistance:1,loot:1,attackspeed:1.25,prodmg:1,movespeed:2,getattack:2},cost:[1e3,0]},{name:"OhMy Hat",desc:"Increased melee and projectile dmg.",source:"hats/ohmy hat.png",id:3,effect:{emp:!1,dmg:1.15,resistance:1,loot:1,attackspeed:1,prodmg:1.15,movespeed:1,getattack:1},cost:[9e3,0]},{name:"Shaw Helmet",desc:"You take less dmg and increased attack speed.",source:"hats/shaw hat.png",id:4,effect:{emp:!1,dmg:1,resistance:.9,loot:1,attackspeed:1.2,prodmg:1,movespeed:1,getattack:1},cost:[1e4,0]},{name:"Farmer Gear",desc:"Increased Drop Loot and mine production.",source:"https://moomoo.io/img/hats/hat_9.png",id:1,effect:{emp:!1,dmg:1,resistance:1,loot:2,attackspeed:1,prodmg:1,movespeed:1,getattack:1},cost:[3e3,0]},{name:"Ranger Gear",desc:"Makes you deal increased projectile damage.",source:"https://moomoo.io/img/hats/hat_1.png",id:2,effect:{emp:!1,dmg:1,resistance:1,loot:1,attackspeed:1,prodmg:1.3,movespeed:1,getattack:1},cost:[6e3,0]},{name:"EMP Helmet",desc:"Hides you from enemy turrets.",source:"https://moomoo.io/img/hats/hat_22.png",id:5,effect:{emp:!0,dmg:1,resistance:1,loot:1,attackspeed:1,prodmg:1,movespeed:1,getattack:1},cost:[12e3,0]},{name:"Fighter Helmet",desc:"Makes you deal increased melee damage.",source:"hats/fighter helmet.png",id:6,effect:{emp:!1,dmg:1.35,resistance:1,loot:1,attackspeed:1,prodmg:1,movespeed:1,getattack:1},cost:[12e3,0]},{name:"Soldier Gear",desc:"Makes you take less damage.",source:"https://moomoo.io/img/hats/hat_6.png",id:7,effect:{emp:!1,dmg:1,resistance:.8,loot:1,attackspeed:1,prodmg:1,movespeed:1,getattack:1},cost:[12e3,0]},{name:"Samurai Gear",desc:"Increased attack speed.",source:"https://moomoo.io/img/hats/hat_20.png",id:8,effect:{emp:!1,dmg:1,resistance:1,loot:1,attackspeed:1.5,prodmg:1,movespeed:1,getattack:1},cost:[12e3,0]},{name:"Bluebell Hat",desc:"Increased all stats.",source:"hats/bluebell hat.png",id:100,effect:{emp:!1,dmg:4,resistance:.5,loot:20,attackspeed:5,prodmg:4,movespeed:2,getattack:1},cost:[5e4,5]},{name:"me mega noob Hat",desc:"Decreased dmg taken, hides you from enemy turrets, increase loot, melee dmg, and movement speed.",source:"hats/me mega noob hat.png",id:101,effect:{emp:!0,dmg:20,resistance:.25,loot:100,attackspeed:1,prodmg:1,movespeed:1.5,getattack:1},cost:[15e4,15]},],y=[{name:"Main Hut",important:!0,health:3e3,maxhealth:3e3,scale:150,upgradeInfo:{upgradeable:!0,cost:300,increase:200},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"Tree",important:!1,health:1/0,maxhealth:1/0,evn:!0,scale:70,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:1,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"Wooden Wall",slot:1,id:1,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[0,0],desc:"Wooden walls are used for defending your defense.",health:70,maxhealth:70,scale:30,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:20,stone:0}},{name:"Stone",important:!1,health:1/0,maxhealth:1/0,scale:60,evn:!0,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:1},onplace:{money:0,wood:0,stone:0}},{name:"Wood Turret",slot:3,id:1,important:!1,zombHittable:!0,cost:[0,0],desc:"Simple Wooden Turret that shoots slow moving projectiles at zombies.",health:80,maxhealth:80,scale:35,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:100,stone:50},turret:{ingorebuilds:!0,type:1,dmg:10,range:400,speed:1e3}},{name:"Wood Spike",slot:2,id:1,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[0,0],desc:"Simple wooden spikes that damage zombies on contact.",health:15,maxhealth:15,scale:30,placeOffset:-5,dmg:10,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:35,stone:20}},{name:"Stone Turret",slot:3,id:2,important:!1,zombHittable:!0,cost:[400,0],desc:"Shoots more powerful projectiles at enemies.",health:100,maxhealth:100,scale:35,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:75,stone:100},turret:{ingorebuilds:!0,type:1,dmg:20,range:400,speed:1e3}},{name:"Stone Wall",slot:1,id:2,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[300,0],desc:"Stone walls are way harder and stronger than Wooden Walls.",health:150,maxhealth:150,scale:30,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:10,stone:30}},{name:"Stone Spike",slot:2,id:2,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[400,0],desc:"More deadlier and more durable than wood spikes.",health:25,maxhealth:25,scale:30,placeOffset:-5,dmg:20,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:20,stone:40}},{name:"Alpha Gold Ore",important:!1,health:1/0,maxhealth:1/0,evn:!0,scale:200,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:2,wood:0,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"Beta Gold Ore",important:!1,health:1/0,maxhealth:1/0,evn:!0,scale:60,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:1,wood:0,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"Wood Generator",slot:4,id:1,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[100,0],desc:"Generates wood to the right of the building.",health:40,maxhealth:40,scale:35,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:200,stone:100},generate:{speed:1e3,type:"wood",worth:4}},{name:"Stone Generator",slot:4,id:2,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[100,0],desc:"Generates stone to the right of the building.",health:40,maxhealth:40,scale:35,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:100,stone:200},generate:{speed:1e3,type:"stone",worth:4}},{name:"Low Turret",slot:3,id:3,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[600,0],desc:"Gives turrets and projectiles the ability to go over the tower. One of a kind.",health:80,maxhealth:80,scale:25,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:70,stone:30},turret:{ingorebuilds:!0,type:1,dmg:5,range:400,speed:2e3}},{name:"Great Stone Wall",slot:1,id:3,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[1e3,0],desc:"Great Stone Wall provides huge defense.",health:400,maxhealth:400,scale:40,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:50,stone:200}},{name:"Grave",allowCannonBall:!0,noColl:!0,health:200,maxhealth:200,evn:!1,scale:45,zombieBuilding:"grave",upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"DOT Spike",slot:2,id:3,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[700,0],desc:"Coats the spikes with posion dealing DoT damage.",health:80,maxhealth:80,scale:25,placeOffset:-5,dmg:7,dot:{dmg:5,last:5e3},upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:55,stone:25}},{name:"Durable Spike",slot:2,id:4,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[1e3,0],desc:"Made with 99% stone these spikes can withstand more than one attack from a anti spike zombie.",health:190,maxhealth:190,scale:35,placeOffset:-5,dmg:25,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:10,stone:70}},{name:"Stone Maker",slot:4,id:5,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[2400,0],desc:"Makes stone, this model is fully automatic.",health:60,maxhealth:60,scale:40,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:90,wood:200,stone:250},generate:{gen:"MK2",speed:300,type:"stone",worth:1.25}},{name:"Wood Maker",slot:4,id:4,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[2400,0],desc:"Makes wood, this model is fully automatic.",health:60,maxhealth:60,scale:40,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:90,wood:250,stone:200},generate:{gen:"MK2",speed:300,type:"wood",worth:1.25}},{name:"Alpha Tree",important:!1,health:1/0,maxhealth:1/0,evn:!0,scale:130,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:5,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"Alpha Stone",important:!1,health:1/0,maxhealth:1/0,evn:!0,scale:130,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:5},onplace:{money:0,wood:0,stone:0}},{name:"Castle Spike",slot:2,id:5,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[1800,0],desc:"Spikes made for guarding protecting forts.",health:400,maxhealth:400,scale:40,placeOffset:-5,dmg:50,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:40,stone:160}},{name:"Turret Gunner",slot:3,id:3,allowCannonBall:!1,important:!1,zombHittable:!0,cost:[1200,0],desc:"Shoots faster and farther than your avg turret.",health:150,maxhealth:150,scale:35,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:200,stone:90},turret:{ingorebuilds:!0,type:1,dmg:18,range:700,speed:400}},{name:"Turret Sniper",slot:3,id:4,allowCannonBall:!1,important:!1,zombHittable:!0,cost:[1800,0],desc:"Shooter stronger and farther bullets.",health:120,maxhealth:120,scale:45,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:100,stone:200},turret:{ingorebuilds:!0,type:2,dmg:100,range:2e3,speed:1500}},{name:"Castle Wall",slot:1,id:4,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[1900,0],desc:"Castle Wall defends castles.",health:900,maxhealth:900,scale:45,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:100,stone:150}},{name:"Triangular Wall",slot:1,id:5,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[2900,0],desc:"Took triangles as the strongest shape way too literally, also deals dmg when touched.",health:2700,maxhealth:2700,scale:35,dmg:5,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:100,stone:200}},{name:"Auto Turret",slot:3,id:6,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[2900,0],desc:"Fires fast and allows projectiles to pass through it.",health:160,maxhealth:160,scale:40,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:200,stone:100},turret:{ingorebuilds:!0,type:2,dmg:20,spread:20,range:500,speed:100}},{name:"Full Dive Sniper Turret",slot:3,id:7,allowCannonBall:!1,important:!1,zombHittable:!0,cost:[4200,0],desc:"Full dive tech allows this turret to fire at emp'd enemies.",health:360,maxhealth:360,scale:45,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:20,wood:200,stone:200},antiemp:!0,turret:{ingorebuilds:!0,type:2,dmg:320,range:1100,speed:1500}},{name:"Mega Grave",allowCannonBall:!0,noColl:!0,health:900,maxhealth:900,evn:!1,scale:40,zombieBuilding:"grave2",upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:0,stone:0}},{name:"Razor Spike",slot:2,id:6,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[2400,0],desc:"These spikes deal a lot of damage but lack in health.",health:550,maxhealth:550,scale:35,placeOffset:-5,dmg:350,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:0,wood:50,stone:200}},{name:"Full Dive Spike",slot:2,id:7,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[3900,0],desc:"Full dive tech allows these to and have a lot of damage and health.",health:1250,maxhealth:1250,scale:35,placeOffset:-5,dmg:500,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:20,wood:50,stone:200}},{name:"Bush",important:!1,health:1/0,maxhealth:1/0,evn:!0,scale:50,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0,food:1},onplace:{money:0,wood:0,stone:0}},{name:"Windmill",slot:4,id:3,allowCannonBall:!0,important:!1,zombHittable:!0,cost:[2300,0],desc:"Makes gold, this model is fully automatic.",health:60,maxhealth:60,scale:40,placeOffset:-5,upgradeInfo:{upgradeable:!1,cost:void 0,increase:void 0},onhit:{money:0,wood:0,stone:0},onplace:{money:200,wood:100,stone:100},generate:{gen:"MK2",speed:1500,type:"money",worth:1}},],h=[{name:"Stone Katana",type:"one",group:"melee",desc:"Great for fighting close range",cost:[500,0],id:3,fixMulti:0,source:"weapons/katana.png",dmg:15,knockback:.3,speed:450,range:140,xOff:-4,yOff:29.5,length:65,width:105},{name:"Wood Bow",type:"one",group:"range",desc:"Ranged weapon, needs wood to fire arrows",cost:[100,0],projectileType:0,id:2,fixMulti:0,source:"https://cdn.discordapp.com/attachments/967213871267971072/995348224762200134/Screenshot_2022-07-09_11.17.54_AM-removebg-preview.png",dmg:15,knockback:.7,speed:500,range:700,onShoot:{wood:5,stone:0},xOff:-6,yOff:0,length:90,width:90},{name:"Wooden Sword",type:"one",group:"melee",desc:"Simple sword made from wood",cost:[0,0],colletMulti:2,id:1,fixMulti:0,source:"weapons/wooden sword.png",dmg:10,knockback:.6,speed:600,range:100,xOff:-4,yOff:29.5,length:65,width:105},{name:"Farming Rake",type:"two",group:"melee",desc:"Farming Rake is uselful for getting more resources!",cost:[50,0],colletMulti:10,id:1,fixMulti:0,source:"weapons/farming rake.png",dmg:.5,knockback:20,speed:400,range:130,xOff:-4,yOff:29.5,length:90,width:105},{name:"Wooden Repair Hammer",type:"two",group:"melee",desc:"Hit Buildings to Repair Them",cost:[100,0],colletMulti:1,id:2,fixMulti:20,source:"weapons/repair hammer.png",dmg:2,knockback:.4,speed:400,range:100,xOff:-4,yOff:29.5,length:65,width:105},{name:"Volley Bow",type:"one",group:"range",desc:"Fast firing inaccurate ranged weapon, needs wood AND stone to fire.",cost:[1500,0],projectileType:0,id:5,fixMulti:0,source:"weapons/volley bow.png",dmg:15,knockback:2,speed:70,range:700,spread:10,onShoot:{wood:5,stone:5},xOff:-6,yOff:0,length:90,width:90},{name:"DOT Katana",type:"one",group:"melee",desc:"Deals DOT (Damage over time) on hit + better + ratio + L",cost:[1500,0],id:4,fixMulti:0,source:"weapons/dot katana.png",dmg:40,knockback:.3,speed:400,range:140,xOff:-4,yOff:29.5,length:65,width:105,dot:{last:3e3,dmg:15}},{name:"Wooden Mace",type:"one",group:"melee",desc:"Smack enemies away + deals great damage",cost:[2500,0],id:5,fixMulti:0,source:"weapons/mace.png",dmg:125,knockback:4,speed:600,range:100,xOff:-4,yOff:29.5,length:65,width:105},{name:"DOT Mace",type:"one",group:"melee",desc:"Smack enemies away + adds DOT (damage over time)",cost:[2e3,0],id:6,fixMulti:0,source:"weapons/dot mace.png",dmg:50,knockback:3,speed:600,range:100,xOff:-4,yOff:29.5,length:65,width:105,dot:{last:4e3,dmg:15}},{name:"Building Demolisher",type:"two",group:"melee",desc:"Deals increased damage to buildings",cost:[1400,0],colletMulti:1,id:3,fixMulti:0,dmgMulti:40,source:"weapons/great hammer1.png",dmg:5,knockback:.4,speed:400,range:90,xOff:-4,yOff:29.5,length:70,width:70},{name:"Wooden Musket",type:"one",group:"range",desc:"Deals a lot of damage, uses stone to fire.",cost:[4e3,0],projectileType:2,id:7,fixMulti:0,source:"weapons/wooden musket.png",dmg:900,knockback:.7,speed:1e3,range:1100,onShoot:{wood:0,stone:20},arm1:.6,arm2:.3,arm3:1.6,xOff:25,yOff:0,length:127,width:127},{name:"Burning Katana",type:"one",group:"melee",desc:"2.0 version of dot katana",cost:[4600,0],id:8,fixMulti:0,source:"weapons/buring katana.png",dmg:80,knockback:.3,speed:300,range:140,xOff:-4,yOff:29.5,length:65,width:105,dot:{dmg:40,last:1e4}},{name:"Stone Mace",type:"one",group:"melee",desc:"A stone mace is enough to smash the skulls of your enemies",cost:[5100,0],id:9,fixMulti:0,source:"weapons/stone mace.png",dmg:300,knockback:4,speed:700,range:100,xOff:-4,yOff:29.5,length:65,width:105},{name:"Stone Musket",type:"one",group:"range",desc:"Deals a lot of damage, uses stone to fire.",cost:[5100,0],projectileType:2,id:10,fixMulti:0,source:"weapons/stone musket.png",dmg:2500,knockback:.7,speed:1e3,range:1100,onShoot:{wood:0,stone:30},arm1:.6,arm2:.3,arm3:1.6,xOff:25,yOff:0,length:127,width:127},{name:"Stone MachineGun",type:"one",group:"range",desc:"Fires a lot of bullets, uses stone as ammo and has spread.",cost:[1e4,0],projectileType:2,projectiles:2,id:13,spread:20,fixMulti:0,source:"weapons/stone musket.png",dmg:200,knockback:0,speed:50,range:600,onShoot:{wood:0,stone:40},arm1:.6,arm2:.3,arm3:1.6,xOff:25,yOff:0,length:96,width:254},{name:"Building Demolisher MK2",type:"two",group:"melee",desc:"Deals even more increased damage to buildings",cost:[2900,0],colletMulti:1,id:5,fixMulti:0,dmgMulti:60,source:"weapons/great hammer2.png",dmg:10,knockback:.4,speed:300,range:90,xOff:-4,yOff:29.5,length:70,width:70},{name:"Shield",type:"two",group:"shield",desc:"Blocks projectiles.",cost:[1900,0],colletMulti:1,id:4,fixMulti:0,source:"https://moomoo.io/img/weapons/shield_1.png",dmg:0,knockback:0,speed:1,range:0,xOff:6,yOff:0,length:90,width:90},{name:"Wooden Wand",type:"one",group:"melee",desc:"Melee weapon that can shoot projectiles at enemies.",cost:[7100,0],projectileType:4,canShootPro:!0,id:11,fixMulti:0,source:"weapons/wooden wand.png",dmg:200,proInfo:{dmg:800,range:1100},knockback:4,spread:0,speed:300,range:100,xOff:-4,yOff:29.5,length:65,width:105},{name:"Stone Shotgun",type:"one",group:"range",desc:"Fires bullets in a arc.",cost:[8100,0],projectileType:2,projectiles:35,id:12,spread:23,fixMulti:0,source:"weapons/shotgun.png",dmg:75,knockback:3,speed:400,range:300,onShoot:{wood:10,stone:50},arm1:.6,arm2:.3,arm3:1.6,xOff:25,yOff:0,length:107,width:254},];var g={enemies:[],players:[]};function f(e,t,n,o,a,l){a.fillRect(e-n/2,t-o/2,n,o),l||a.strokeRect(e-n/2,t-o/2,n,o)}function u(e,t,n,o){let a=Math.PI/2*3,l=Math.PI/t,s;e.beginPath(),e.moveTo(0,-o);for(let i=0;i<t;i++)s=Math.randInt(n+.9,1.2*n),e.quadraticCurveTo(Math.cos(a+l)*s,Math.sin(a+l)*s,Math.cos(a+2*l)*o,Math.sin(a+2*l)*o),a+=2*l;e.lineTo(0,-o),e.closePath()}function _(e,t,n,o,a){let l=Math.PI/2*3,s,i,$=Math.PI/t;e.beginPath(),e.moveTo(0,-n);for(let d=0;d<t;d++)s=Math.cos(l)*n,i=Math.sin(l)*n,e.lineTo(s,i),l+=$,s=Math.cos(l)*o,i=Math.sin(l)*o,e.lineTo(s,i),l+=$;e.lineTo(0,-n),e.closePath(),a&&e.stroke()}function v(e,t,n,o,l,s,i,$){(o=o||a).beginPath(),o.arc(e,t,n,0,2*Math.PI),o.fillStyle=i,o.lineWidth=4,o.strokeStyle=$,s||o.fill(),l||o.stroke()}function k(e,t){if(t){let n=Math.PI/4;v(e.scale*Math.cos(n),e.scale*Math.sin(n),e.scale/2,a,!1,!1,e.color,"#000"),v(e.scale*Math.cos(-n),e.scale*Math.sin(-n),e.scale/2,a,!1,!1,e.color,"#000")}else{let o=Math.PI/4*(0==e.buildIndex&&h[e.currentWeapon].arm1||1),l=0==e.buildIndex&&h[e.currentWeapon].arm2||1,s=0==e.buildIndex&&h[e.currentWeapon].arm3||1;v(e.scale*s*Math.cos(o),e.scale*Math.sin(o),10,a,!1,!1,"#bf8f54","#000"),v(e.scale*s*Math.cos(-o*l),1*e.scale*Math.sin(-o*l),10,a,!1,!1,"#bf8f54","#000")}}t.addEventListener("message",async function(e){let t=await e.data.arrayBuffer(),o=window.msgpack.decode(new Uint8Array(t));switch(o[0]){case"update players":l=o[1][0];for(let a=0;a<l.length;a++){let s=l[a];n&&s.sid==n.sid&&(n=s)}break;case"map data":g.enemies=[],g.players=[],g.players=o[1][1],g.enemies=o[1][0];break;case"set sid":(n={}).sid=o[1][0];break;case"ping":document.getElementById("ping").innerHTML="Ping: "+(Date.now()-C)+" ms";break;case"update enemies":$=[],$=o[1][0];break;case"update buildings":d=[],d=o[1][0];break;case"update projectiles":c=[],c=o[1][0];break;case"kill":document.getElementById("mainMenu").style.display="block",document.getElementById("stuffDisplay").style.display="none",document.getElementById("shopButton").style.display="none",document.getElementById("updateLogs").style.display="none",document.getElementById("taskButton").style.display="none";break;case"idk now":setTimeout(()=>{en()},20)}}),t.addEventListener("close",e=>{e.reason?document.body.innerHTML=e.reason:document.body.innerHTML="Disconnected."}),window.addEventListener("resize",function e(){o.width=window.innerWidth,o.height=window.innerHeight}),o.width=window.innerWidth,o.height=window.innerHeight;var b={},w=[];function I(e,t){let n=w[e.name];if(!n||t){let o=document.createElement("canvas");o.width=o.height=e.scale*(e.evn?5:2.5);let a=o.getContext("2d");if(a.translate(o.width/2,o.height/2),a.rotate(t?0:Math.PI/2),a.lineWidth=5.5,"Main Hut"==e.name)a.fillStyle="#f07905",a.strokeStyle="#000",_(a,50,1.2266666666636*e.scale,e.scale,!0),a.fill(),a.fillStyle="#e37305",_(a,45,1.1333333333305*e.scale,1.199999999997*e.scale),a.fill(),a.fillStyle="#d16a04",_(a,40,.9999999999975*e.scale,1.066666666664*e.scale),a.fill(),a.fillStyle="#c26204",_(a,40,.8666666666645*e.scale,.7*e.scale*1.33333333333),a.fill(),a.fillStyle="#b35b04",_(a,35,.7333333333315*e.scale,.799999999998*e.scale),a.fill(),a.fillStyle="#964B00",_(a,30,.399999999999*e.scale,.666666666665*e.scale),a.fill(),v(0,0,.266666666666*e.scale,a,!1,!1,"#693402","#804003");else if("Tree"==e.name||"Alpha Tree"==e.name)a.lineWidth=3,u(a,14,1.6*e.scale,1.4*e.scale),a.fillStyle="#00ff00",a.fill(),a.stroke(),u(a,13,1.4*e.scale,1.2*e.scale),a.fillStyle="#02e302",a.fill(),a.stroke(),u(a,14,1.2*e.scale,.9*e.scale),a.fillStyle="#02cc02",a.fill(),a.stroke(),u(a,13,.9*e.scale,.7*e.scale),a.fillStyle="#02b502",a.fill(),a.stroke(),u(a,13,.7*e.scale,.4*e.scale),a.fillStyle="##019401",a.fill(),a.stroke();else if("Wooden Wall"==e.name||"Stone Wall"==e.name||"Great Stone Wall"==e.name||"Castle Wall"==e.name||"Triangular Wall"==e.name)a.fillStyle="Wooden Wall"==e.name?"#964B00":"#b7b09c",a.strokeStyle="#000",_(a,"Great Stone Wall"==e.name?7:"Castle Wall"==e.name?6:"Triangular Wall"==e.name?1.5:5,1.1*e.scale,1.1*e.scale,!0),a.fill(),a.fillStyle="Wooden Wall"==e.name?"#6e3904":"#706d63",_(a,"Great Stone Wall"==e.name?7:"Castle Wall"==e.name?6:"Triangular Wall"==e.name?1.5:5,e.scale*("Castle Wall"==e.name?.8:.65),e.scale*("Castle Wall"==e.name?.8:.65)),a.fill(),"Castle Wall"==e.name&&(a.fillStyle="#45433d",_(a,6,.35*e.scale,.35*e.scale),a.fill());else if("Stone"==e.name||"Alpha Stone"==e.name)u(a,8,e.scale,.95*e.scale),a.lineWidth=3,a.fillStyle="#938d77",a.fill(),a.stroke(),u(a,7,.65*e.scale,.6*e.scale),a.fillStyle="#615e52",a.fill(),a.stroke();else if("Wood Turret"==e.name||"Stone Turret"==e.name||"Low Turret"==e.name||"Turret Gunner"==e.name||"Turret Sniper"==e.name||"Auto Turret"==e.name||"Full Dive Sniper Turret"==e.name)"Auto Turret"==e.name?(a.fillStyle="#808080",a.strokeStyle="#000",_(a,4,e.scale,e.scale,!0),a.fill(),f(0,-25,.9*e.scale,50,a),v(0,0,.6*e.scale,a,!0,!1,"#f00"),a.fill(),a.stroke()):(v(0,0,e.scale,a,!1,!1,"Wood Turret"==e.name||"Low Turret"==e.name?"#f07905":"#B7B09C","Turret Gunner"==e.name?"#fff":"Turret Sniper"==e.name?"#808080":"#000"),f(0,-25,.9*e.scale,50,a),v(0,0,.6*e.scale,a,!0,!1,"Low Turret"==e.name?"#fff":"Turret Gunner"==e.name?"#00ff00":"Full Dive Sniper Turret"==e.name?"#ff0000":"#000","Turret Sniper"==e.name?"#ff0000":"Full Dive Sniper Turret"==e.name?"#ff0000":"#000"),a.fill(),a.stroke());else if("Wood Spike"==e.name||"Stone Spike"==e.name||"DOT Spike"==e.name||"Durable Spike"==e.name||"Castle Spike"==e.name||"Razor Spike"==e.name||"Full Dive Spike"==e.name)a.fillStyle="DOT Spike"==e.name?"#00ff00":"Full Dive Spike"==e.name?"#fff":"#000",a.strokeStyle="Razor Spike"==e.name?"#f00":"Full Dive Spike"==e.name?"#0000ff":"#000",_(a,"Durable Spike"==e.name?6:"Castle Spike"==e.name?11:"Razor Spike"==e.name||"Full Dive Spike"==e.name?8:5,e.scale,.6*e.scale,!0),a.fill(),v(0,0,e.scale*("Castle Spike"==e.name?.9:"Razor Spike"==e.name?.75:.6),a,!0,!1,"Wood Spike"==e.name?"#f07905":"DOT Spike"==e.name?"#000":"Full Dive Spike"==e.name?"#0000ff":"#B7B09C");else if("Alpha Gold Ore"==e.name||"Beta Gold Ore"==e.name)a.fillStyle="#ffd700",a.strokeStyle="#000",_(a,3,e.scale,e.scale,!0),a.fill(),a.fillStyle="#c9ae1c",_(a,3,.55*e.scale,.65*e.scale),a.fill();else if("Wood Generator"==e.name||"Wood Maker"==e.name||"Windmill"==e.name)a.fillStyle="Windmill"==e.name?"#ffd700":"#964B00",a.strokeStyle="Windmill"==e.name?"#000":"#b7b09c",_(a,"Wood Maker"==e.name?5:6,e.scale,e.scale,!0),a.fill(),a.fillStyle="Windmill"==e.name?"#ab9109":"#6e3904",_(a,"Wood Maker"==e.name?5:6,.55*e.scale,.65*e.scale),a.fill(),"Wood Maker"==e.name&&(a.fillStyle="#b7b09c",_(a,"Wood Maker"==e.name?5:6,.25*e.scale,.35*e.scale),a.fill());else if("Stone Generator"==e.name||"Stone Maker"==e.name)a.fillStyle="#b7b09",a.strokeStyle="#964B00c",_(a,"Stone Maker"==e.name?5:6,e.scale,e.scale,!0),a.fill(),a.fillStyle="#706d63",_(a,"Stone Maker"==e.name?5:6,.55*e.scale,.65*e.scale),a.fill(),"Stone Maker"==e.name&&(a.fillStyle="#b7b09",_(a,"Stone Maker"==e.name?5:6,.25*e.scale,.35*e.scale),a.fill());else if("Grave"==e.name||"Mega Grave"==e.name)a.fillStyle="#b7b09c",a.strokeStyle="#000",_(a,"Mega Grave"==e.name?5:8,e.scale,e.scale,!0),a.fill(),a.fillStyle="#858072",_(a,"Mega Grave"==e.name?5:8,.65*e.scale,.75*e.scale),a.fill(),a.fillStyle="#59564c",_(a,"Mega Grave"==e.name?5:8,.25*e.scale,.35*e.scale),a.fill();else if("Bush"==e.name){u(a,6,e.scale,.7*e.scale),a.fillStyle="#89a54c",a.fill(),a.stroke(),a.fillStyle="#c15555";let l,s=2*Math.PI/4;for(var i=0;i<4;++i)v((l=Math.randInt(e.scale/3.5,e.scale/2.3))*Math.cos(s*i),l*Math.sin(s*i),Math.randInt(10,12),a)}n=o,w[e.name]=n}return n}function x(e){a.globalAlpha=1;let t=I(e);"not anymore"!=e.active&&(a.save(),a.translate(e.x+e.xMove-s.x,e.y+e.yMove-s.y),a.rotate(e.dir||0),a.drawImage(t,-(t.width/2),-(t.height/2)),a.restore())}function B(e,t,n){a.globalAlpha=1,a.save(),a.translate(n.x-e,n.y-t),a.rotate(n.dir),k(n,"enemies"),v(0,0,n.scale,a,!1,!1,n.color,"#000"),a.restore()}var S={};function E(e,t,o){if(a.globalAlpha=1,a.save(),a.translate(o.x-e,o.y-t),a.rotate((o==n?L():o.dir)-o.dirPlus),0==o.buildIndex){var l,s,i,$,d;let c,r;i=h[o.currentWeapon],$=o.scale,d=a,(r=b[c=i.source])||((r=new Image).src=i.source,r.onload=function(){r.isLoaded=!0},b[c]=r),!0==r.isLoaded&&d.drawImage(r,$+i.xOff-i.length/2,0+i.yOff-i.width/2,i.length,i.width)}if(k(o),v(0,0,o.scale,a,!1,!1,"#bf8f54","#000"),o.buildIndex>0){let m=I(y[o.buildIndex]);a.drawImage(m,o.scale-8,-m.width/2)}if(o.hatIndex>-1){let g;l=p[o.hatIndex],s=a,(g=S[l.source])||((g=new Image).src=l.source,g.onload=function(){this.isLoaded=!0},S[l.source]=g),g.isLoaded&&(a.rotate(Math.PI/2),s.drawImage(g,-35,-35,70,70))}a.restore()}function T(e){1==t.readyState&&t.send(new Uint8Array(Array.from(window.msgpack.encode(e))))}o.addEventListener("click",e=>{n.isAlive&&(0==n.buildIndex?T(["hit",[h[n.currentWeapon],r[h[n.currentWeapon].projectileType],n.currentWeapon]]):T(["place",[n.buildIndex]]))},0);var M=!1,W={w:!1,a:!1,s:!1,d:!1,space:!1},H=0;document.addEventListener("keydown",e=>{if(!n||n.isAlive){if("w"==e.key&&"chatbox"!==document.activeElement.id.toLowerCase()&&(W.w=!0),"a"==e.key&&"chatbox"!==document.activeElement.id.toLowerCase()&&(W.a=!0),"s"==e.key&&"chatbox"!==document.activeElement.id.toLowerCase()&&(W.s=!0),"d"==e.key&&"chatbox"!==document.activeElement.id.toLowerCase()&&(W.d=!0),32==e.keyCode&&"chatbox"!==document.activeElement.id.toLowerCase()&&(W.space=!0),13==e.keyCode){if("block"==document.getElementById("holdchatbar").style.display)Date.now()-H>500&&document.getElementById("chatbox").value&&(T(["chat",[document.getElementById("chatbox").value]]),H=Date.now(),document.getElementById("chatbox").value=""),document.getElementById("holdchatbar").style.display="none";else{document.getElementById("holdchatbar").style.display="block";document.getElementById("chatbox").focus()}}if(n&&"none"==n.weapons[1]&&"chatbox"!==document.activeElement.id.toLowerCase()){let t=e.key;"1"==t?T(["hold building",[0,n.weapons[0],"primary"]]):"2"==t?T(["hold building",[n.items[0],null,"wall"]]):"3"==t?T(["hold building",[n.items[1],null,"spike"]]):"4"==t?T(["hold building",[n.items[2],null,"turret"]]):"5"==t&&n.items[3]&&T(["hold building",[n.items[3],null,"maker"]])}else if(n&&"chatbox"!==document.activeElement.id.toLowerCase()){let o=e.key;"1"==o?T(["hold building",[0,n.weapons[0],"primary"]]):"2"==o?T(["hold building",[0,n.weapons[1],"secondary"]]):"3"==o?T(["hold building",[n.items[0],null,"wall"]]):"4"==o?T(["hold building",[n.items[1],null,"spike"]]):"5"==o?T(["hold building",[n.items[2],null,"turret"]]):"6"==o&&n.items[3]&&T(["hold building",[n.items[3],null,"maker"]])}}}),document.addEventListener("keyup",e=>{"w"==e.key&&(W.w=!1),"a"==e.key&&(W.a=!1),"s"==e.key&&(W.s=!1),"d"==e.key&&(W.d=!1),32==e.keyCode&&(W.space=!1),"q"==e.key&&"chatbox"!==document.activeElement.id.toLowerCase()&&n.resource.food-m[n.healType].onheal>=0&&n.health<n.maxhealth&&T(["heal",[m[n.healType]]])}),window.startWave=function(){},window.startGame=function(){1==t.readyState?(document.getElementById("mainMenu").style.display="none",document.getElementById("shopButton").style.display="block",document.getElementById("updateLogs").style.display="block",document.getElementById("ping").style.display="block",document.getElementById("stuffDisplay").style.display="block",!1==M?(M=!0,T(["new",[document.getElementById("name").value?document.getElementById("name").value:"lazybone"]])):(console.log("respawing"),T(["respawn",[document.getElementById("name").value?document.getElementById("name").value:"lazybone"]])),document.getElementById("name").value&&localStorage.setItem("name",document.getElementById("name").value)):alert("Connection to the WebSocket Server is not established yet. Please wait awhile before trying to enter the game again.")},localStorage.getItem("name")&&(document.getElementById("name").value=localStorage.getItem("name")),CanvasRenderingContext2D.prototype.roundRect=function(e,t,n,o,a){return n<2*a&&(a=n/2),o<2*a&&(a=o/2),a<0&&(a=0),this.beginPath(),this.moveTo(e+a,t),this.arcTo(e+n,t,e+n,t+o,a),this.arcTo(e+n,t+o,e,t+o,a),this.arcTo(e,t+o,e,t,a),this.arcTo(e,t,e+n,t,a),this.closePath(),this};var A=document.getElementById("miniMap");A.width=300,A.height=300;var O=A.getContext("2d"),C=0;function L(){return Math.atan2(window.mouseY-o.height/2,window.mouseX-o.width/2)}setInterval(()=>{C=Date.now(),T(["ping server"])},1e3),o.addEventListener("mousemove",function(e){(window.mouseX!==e.clientX||window.mouseY!==e.clientY)&&(window.mouseX=e.clientX,window.mouseY=e.clientY)});var G={};function P(e){a.globalAlpha=1,a.save(),a.translate(e.x-s.x,e.y-s.y),a.rotate(e.dir),function e(t,n,o,a){if(o.source){let l=o.source,s=G[l];s||((s=new Image).onload=function(){this.isLoaded=!0},s.src=l,G[l]=s),s.isLoaded&&a.drawImage(s,0-o.scale/2,0-o.scale/2,o.scale,o.scale)}else v(0,0,o.scale,a,!1,!1,"Redball"==o.name?"#f00":"Wand Spell"==o.name?"#0000ff":"#808080","#000")}(0,0,e,a),a.restore()}window.requestAnimationFrame=window.requestAnimationFrame||window.requestAnimationFrame||window.requestAnimationFrame||function(e){window.setTimeout(e,1)},function e(){(function e(){if(s=n?{x:n.x-o.width/2,y:n.y-o.height/2}:{x:4500-o.width/2,y:4500-o.height/2},function e(){let t=i.scale-2200;if(t-s.x>=window.innerWidth?(a.fillStyle="#96b553",a.fillRect(0,0,window.innerWidth,window.innerHeight)):t-s.x>=0?(a.fillStyle="#96b553",a.fillRect(0,0,t-s.x,window.innerHeight),a.fillStyle="#4f5e2e",a.fillRect(t-s.x,0,window.innerWidth-(t-s.x),window.innerHeight)):(a.fillStyle="#4f5e2e",a.fillRect(0,0,window.innerWidth,window.innerHeight)),a.stroke(),a.fillStyle="#000",a.globalAlpha=.09,s.x<=0&&a.fillRect(0,0,-s.x,window.innerHeight),i.scale-s.x<=window.innerWidth){let n=Math.max(0,-s.y);a.fillRect(i.scale-s.x,n,window.innerWidth-(i.scale-s.x),window.innerHeight-n)}if(s.y<=0&&a.fillRect(-s.x,0,window.innerWidth+s.x,-s.y),i.scale-s.y<=window.innerHeight){let o=Math.max(0,-s.x),l=0;i.scale-s.x<=window.innerWidth&&(l=window.innerWidth-(i.scale-s.x)),a.fillRect(o,i.scale-s.y,window.innerWidth-o-l,window.innerHeight-(i.scale-s.y))}}(),n&&!0==n.isAlive&&(T(["set aim",[L()]]),E(s.x,s.y,n),function e(){if(!0==W.space&&n.isAlive){let t=n.currentWeapon==n.weapons[0]?n.weapons[0]:n.weapons[1];0==n.buildIndex&&(t==n.weapons[0]?n.lastHit.one:n.lastHit.two)==h[n.currentWeapon].speed?T(["hit",[h[n.currentWeapon],r[h[n.currentWeapon].projectileType],n.currentWeapon]]):n.buildIndex>0&&T(["place",[n.buildIndex]])}document.getElementById("stoneAmount").innerHTML=Math.round(n.resource.stone),document.getElementById("woodAmount").innerHTML=Math.round(n.resource.wood),document.getElementById("moneyAmount").innerHTML=Math.round(n.resource.money),document.getElementById("foodAmount").innerHTML=Math.round(n.resource.food),document.getElementById("ptamount").innerHTML=Math.round(n.resource.platinum),(W.w||W.a||W.s||W.d)&&T(["move",[((W.w&&W.a?315:W.a&&W.s?225:W.s&&W.d?135:W.d&&W.w?45:W.w?0:W.a?270:W.s?180:90)-90)/180*Math.PI]])}()),l.length)for(let t=0;t<l.length;t++)l[t].sid!=n.sid&&E(s.x,s.y,l[t]);for(let m=0;m<$.length;m++)B(s.x,s.y,$[m]),a.globalAlpha=1,a.font="20px Comic Sans MS",a.fillStyle="#fff",a.textBaseline="middle",a.textAlign="center",a.lineWidth=6,a.lineJoin="round",a.strokeText($[m].name,$[m].x-s.x,$[m].y-s.y-$[m].scale-34),a.fillText($[m].name,$[m].x-s.x,$[m].y-s.y-$[m].scale-34),a.fillStyle="#000",a.roundRect($[m].x-s.x-30-4.5,$[m].y-s.y+$[m].scale+11,69,17,8),a.fill(),a.fillStyle="#ff0000",a.roundRect($[m].x-s.x-30,$[m].y-s.y+$[m].scale+11+4.5,60*($[m].health/$[m].maxhealth),8,7),a.fill();for(let p=0;p<c.length;p++)P(c[p]);for(let y=0;y<d.length;y++)x(d[y]),(!0==d[y].important||"Mega Grave"==d[y].name||"Grave"==d[y].name||n&&n.currentWeapon&&"Wooden Repair Hammer"==h[n.currentWeapon].name)&&!d[y].evn&&(a.font="20px Comic Sans MS",a.fillStyle="#fff",a.textBaseline="middle",a.textAlign="center",a.lineWidth=6,a.lineJoin="round",a.strokeText("Main Hut"==d[y].name?"Main Hut ("+Math.round(d[y].health)+"/"+Math.round(d[y].maxhealth)+" HP)":d[y].name,d[y].x-s.x,d[y].y-s.y-d[y].scale),a.fillText("Main Hut"==d[y].name?"Main Hut ("+Math.round(d[y].health)+"/"+Math.round(d[y].maxhealth)+" HP)":d[y].name,d[y].x-s.x,d[y].y-s.y-d[y].scale),a.fillStyle="#000",a.roundRect(d[y].x-s.x-30-4.5,d[y].y-s.y+d[y].scale+11,69,17,8),a.fill(),a.fillStyle="Mega Grave"==d[y].name||"Grave"==d[y].name||d[y].isAlly?"#ff0000":"#8ecc51",a.roundRect(d[y].x-s.x-30,d[y].y-s.y+d[y].scale+11+4.5,60*(d[y].health/d[y].maxhealth),8,7),a.fill());if(a.globalAlpha=.3,a.fillStyle="rgba(0, 0, 70, 0.3)",a.fillRect(0,0,o.width,o.height),n&&!0==n.isAlive){if(""!=n.chatMessage){a.globalAlpha=1,a.font="24px Comic Sans MS";let f=a.measureText(n.chatMessage);a.textBaseline="middle",a.textAlign="center";let u=n.x-s.x,_=n.y-n.scale/2-s.y-90;a.fillStyle="rgba(0,0,0,0.2)",a.roundRect(u-(f.width+17)/2,_-20,f.width+17,37,6),a.fill(),a.fillStyle="#fff",a.fillText(n.chatMessage,u,_)}a.globalAlpha=1,a.font="20px Comic Sans MS",a.fillStyle="#fff",a.textBaseline="middle",a.textAlign="center",a.lineWidth=6,a.lineJoin="round",a.strokeText("(Lv"+n.level+") "+n.name+" ("+n.health+"/"+n.maxhealth+" HP)",n.x-s.x,n.y-s.y-n.scale-34),a.fillText("(Lv"+n.level+") "+n.name+" ("+n.health+"/"+n.maxhealth+" HP)",n.x-s.x,n.y-s.y-n.scale-34),a.fillStyle="#000",a.roundRect(n.x-s.x-30-4.5,n.y-s.y+n.scale+11,69,17,8),a.fill(),a.fillStyle="#8ecc51",a.roundRect(n.x-s.x-30,n.y-s.y+n.scale+11+4.5,60*(n.health/n.maxhealth),8,7),a.fill(),a.fillStyle="#000",a.roundRect(n.x-s.x-30-4.5,n.y-s.y+n.scale+27,69,17,8),a.fill(),a.fillStyle="#6060f7",a.roundRect(n.x-s.x-30,n.y-s.y+n.scale+27+4.5,60*(n.xp[0]/n.xp[1]),8,7),a.fill(),a.fillStyle="#000",a.roundRect(n.x-s.x-30-4.5,n.y-s.y+n.scale+43,39,17,8),a.fill(),a.fillStyle="#fff",a.roundRect(n.x-s.x-30,n.y-s.y+n.scale+43+4.5,30*(n.lastHit.one/h[n.weapons[0]].speed),8,7),a.fill()}if(l.length){for(let k=0;k<l.length;k++)if(l[k].sid!=n.sid&&l[k].isAlive){if(""!=l[k].chatMessage){a.globalAlpha=1,a.font="24px Comic Sans MS";let b=a.measureText(l[k].chatMessage);a.textBaseline="middle",a.textAlign="center";let w=l[k].x-s.x,I=l[k].y-l[k].scale/2-s.y-90;a.fillStyle="rgba(0,0,0,0.2)",a.roundRect(w-(b.width+17)/2,I-20,b.width+17,37,6),a.fill(),a.fillStyle="#fff",a.fillText(l[k].chatMessage,w,I)}a.globalAlpha=1,a.font="20px Comic Sans MS",a.fillStyle="#fff",a.textBaseline="middle",a.textAlign="center",a.lineWidth=6,a.lineJoin="round",a.strokeText((n.isadmin?"(Sid: "+l[k].sid+") ":"")+"(Lv"+l[k].level+") "+l[k].name+" ("+l[k].health+"/"+l[k].maxhealth+" HP)",l[k].x-s.x,l[k].y-s.y-l[k].scale-34),a.fillText((n.isadmin?"(Sid: "+l[k].sid+") ":"")+"(Lv"+l[k].level+") "+l[k].name+" ("+l[k].health+"/"+l[k].maxhealth+" HP)",l[k].x-s.x,l[k].y-s.y-l[k].scale-34),a.fillStyle="#000",a.roundRect(l[k].x-s.x-30-4.5,l[k].y-s.y+l[k].scale+11,69,17,8),a.fill(),a.fillStyle="#8ecc51",a.roundRect(l[k].x-s.x-30,l[k].y-s.y+l[k].scale+11+4.5,60*(l[k].health/l[k].maxhealth),8,7),a.fill(),a.fillStyle="#000",a.roundRect(l[k].x-s.x-30-4.5,l[k].y-s.y+l[k].scale+27,69,17,8),a.fill(),a.fillStyle="#6060f7",a.roundRect(l[k].x-s.x-30,l[k].y-s.y+l[k].scale+27+4.5,60*(l[k].xp[0]/l[k].xp[1]),8,7),a.fill(),a.fillStyle="#000",a.roundRect(l[k].x-s.x-30-4.5,l[k].y-s.y+l[k].scale+43,39,17,8),a.fill(),a.fillStyle="#fff",a.roundRect(l[k].x-s.x-30,l[k].y-s.y+n.scale+43+4.5,30*(l[k].lastHit.one/h[l[k].weapons[0]].speed),8,7),a.fill()}}!function e(){O.clearRect(0,0,300,300),n&&v(n.x/i.scale*300,n.y/i.scale*300,7,O,!0,!1,"#fff");for(let t=0;t<g.enemies.length;t++)v(g.enemies[t].x/i.scale*300,g.enemies[t].y/i.scale*300,7,O,!0,!1,"#f00");if(g.players.length)for(let o=0;o<g.players.length;o++)n&&g.players[o].sid!=n.sid&&(O.globalAlpha=.6,v(g.players[o].x/i.scale*300,g.players[o].y/i.scale*300,7,O,!0,!1,"#fff"))}()})(),requestAnimationFrame(e)}(),document.getElementById("open1").onclick=function(){document.getElementById("contentPri").style.display="block",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="none"},document.getElementById("open2").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="block",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="none"},document.getElementById("open3").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="block",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="none"},document.getElementById("open4").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="block",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="none"},document.getElementById("open5").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="block",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="none"},document.getElementById("openInv").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="block",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="none"},document.getElementById("openHats").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="block",document.getElementById("contentMake").style.display="none"},document.getElementById("open6").onclick=function(){document.getElementById("contentPri").style.display="none",document.getElementById("contentSec").style.display="none",document.getElementById("contentWall").style.display="none",document.getElementById("contentSpike").style.display="none",document.getElementById("contentTurret").style.display="none",document.getElementById("contentHealing").style.display="none",document.getElementById("contentHats").style.display="none",document.getElementById("contentMake").style.display="block"};var z=[];z["Wooden Sword"]=!0,z["Wood Turret"]=!0,z["Wooden Wall"]=!0,z["Wood Spike"]=!0,z["Small Apple"]=!0;let q=h.filter(e=>"one"==e.type).sort((e,t)=>e.id-t.id);for(let R=0;R<q.length;R++)document.getElementById("contentPri").innerHTML+=`
    <div class="stopItem">
    <h3>${q[R].name}</h3>
    <div style="font-size: 15px;">${q[R].desc}</div>
    <div class = "shopButton" onclick = "manageItems('primary', '${q[R].name}')">${z[q[R].name]?n&&h[n.weapons[0]].name==q[R].name?"Equipped":q[R].cost[0]<1&&q[R].cost[1]<1?"Equipped":"Equip":"Buy ("+q[R].cost[0]+" AG, "+q[R].cost[1]+" PT)"}</div>
    </div>
    `;let D=h.filter(e=>"two"==e.type).sort((e,t)=>e.id-t.id);for(let F=0;F<D.length;F++)document.getElementById("contentSec").innerHTML+=`
    <div class="stopItem">
    <h3>${D[F].name}</h3>
    <div style="font-size: 15px;">${D[F].desc}</div>
    <div class = "shopButton" onclick = "manageItems('secondary', '${D[F].name}')">${z[D[F].name]?n&&h[n.weapons[1]].name==D[F].name?"Equipped":D[F].cost[0]<1&&D[F].cost[1]<1?"Equipped":"Equip":"Buy ("+D[F].cost[0]+" AG, "+D[F].cost[1]+" PT)"}</div>
    </div>
    `;let j=y.filter(e=>3==e.slot).sort((e,t)=>e.id-t.id);for(let Y=0;Y<j.length;Y++)document.getElementById("contentTurret").innerHTML+=`
    <div class="stopItem">
    <h3>${j[Y].name}</h3>
    <div style="font-size: 15px;">${j[Y].desc}<br>
    Costs: ${j[Y].onplace.money} AG, ${j[Y].onplace.wood} Wood, ${j[Y].onplace.stone} Stone to place</div>
    <div class = "shopButton"onclick = "manageItems('slot3', '${j[Y].name}')">${z[j[Y].name]?n&&y[n.items[2]].name==j[Y].name?"Equipped":j[Y].cost[0]<1&&j[Y].cost[1]<1?"Equipped":"Equip":"Buy ("+j[Y].cost[0]+" AG, "+j[Y].cost[1]+" PT)"}</div>
    </div>
    `;let K=y.filter(e=>1==e.slot).sort((e,t)=>e.id-t.id);for(let V=0;V<K.length;V++)document.getElementById("contentWall").innerHTML+=`
    <div class="stopItem">
    <h3>${K[V].name}</h3>
    <div style="font-size: 15px;">${K[V].desc}<br>
    Costs: ${K[V].onplace.money} AG, ${K[V].onplace.wood} Wood, ${K[V].onplace.stone} Stone to place</div>
    <div class = "shopButton" onclick = "manageItems('slot1', '${K[V].name}')">${z[K[V].name]?n&&y[n.items[0]].name==K[V].name?"Equipped":K[V].cost[0]<1&&K[V].cost[1]<1?"Equipped":"Equip":"Buy ("+K[V].cost[0]+" AG, "+K[V].cost[1]+" PT)"}</div>
    </div>
    `;let U=y.filter(e=>2==e.slot).sort((e,t)=>e.id-t.id);for(let X=0;X<U.length;X++)document.getElementById("contentSpike").innerHTML+=`
    <div class="stopItem">
    <h3>${U[X].name}</h3>
    <div style="font-size: 15px;">${U[X].desc}<br>
    Costs: ${U[X].onplace.money} AG, ${U[X].onplace.wood} Wood, ${U[X].onplace.stone} Stone to place</div>
    <div class = "shopButton" onclick = "manageItems('slot2', '${U[X].name}')">${z[U[X].name]?n&&y[n.items[1]].name==U[X].name?"Equipped":U[X].cost[0]<1&&U[X].cost[1]<1?"Equipped":"Equip":"Buy ("+U[X].cost[0]+" AG, "+U[X].cost[1]+" PT)"}</div>
    </div>
    `;let J=y.filter(e=>4==e.slot).sort((e,t)=>e.id-t.id);for(let N=0;N<J.length;N++)document.getElementById("contentMake").innerHTML+=`
    <div class="stopItem">
    <h3>${J[N].name}</h3>
    <div style="font-size: 15px;">${J[N].desc}<br>
    Costs: ${J[N].onplace.money} AG, ${J[N].onplace.wood} Wood, ${J[N].onplace.stone} Stone to place</div>
    <div class = "shopButton" onclick = "manageItems('slot4', '${J[N].name}')">${z[J[N].name]?n&&n.items[3]&&y[n.items[3]].name==J[N].name?"Equipped":J[N].cost[0]<1&&J[N].cost[1]<1?"Equipped":"Equip":"Buy ("+J[N].cost[0]+" AG, "+J[N].cost[1]+" PT)"}</div>
    </div>
    `;let Z=m.sort((e,t)=>e.id-t.id);for(let Q=0;Q<Z.length;Q++)document.getElementById("contentHealing").innerHTML+=`
    <div class="stopItem">
    <h3>${Z[Q].name}</h3>
    <div style="font-size: 15px;">${Z[Q].desc}<br>
    Uses: ${Z[Q].onheal} Food</div>
    <div class = "shopButton" onclick = "manageItems('healtype', '${Z[Q].name}')">${z[Z[Q].name]?n&&m[n.healType].name==Z[Q].name?"Equipped":Z[Q].cost[0]<1&&Z[Q].cost[1]<1?"Equipped":"Equip":"Buy ("+Z[Q].cost[0]+" AG, "+Z[Q].cost[1]+" PT)"}</div>
    </div>
    `;let ee=p.sort((e,t)=>e.id-t.id);for(let et=0;et<ee.length;et++)document.getElementById("contentHats").innerHTML+=`
    <div class="stopItem">
    <h3>${ee[et].name}</h3>
    <div style="font-size: 15px;">${ee[et].desc}<br>
    </div>
    <div class = "shopButton" onclick = "manageItems('hat', '${ee[et].name}')">${z[ee[et].name]?n&&p[n.hatIndex].name==ee[et].name?"Equipped":ee[et].cost[0]<1&&ee[et].cost[1]<1?"Equipped":"Equip":"Buy ("+ee[et].cost[0]+" AG, "+ee[et].cost[1]+" PT)"}</div>
    </div>
    `;function en(){document.getElementById("contentPri").innerHTML="";for(let e=0;e<q.length;e++)document.getElementById("contentPri").innerHTML+=`
    <div class="stopItem">
    <h3>${q[e].name}</h3>
    <div style="font-size: 15px;">${q[e].desc}</div>
    <div class = "shopButton" onclick = "manageItems('primary', '${q[e].name}')">${z[q[e].name]?h[n.weapons[0]].name==q[e].name?"Equipped":"Equip":"Buy ("+q[e].cost[0]+" AG, "+q[e].cost[1]+" PT)"}</div>
    </div>
    `;document.getElementById("contentSec").innerHTML="";for(let t=0;t<D.length;t++)document.getElementById("contentSec").innerHTML+=`
    <div class="stopItem">
    <h3>${D[t].name}</h3>
    <div style="font-size: 15px;">${D[t].desc}</div>
    <div class = "shopButton" onclick = "manageItems('secondary', '${D[t].name}')">${z[D[t].name]?"none"!=n.weapons[1]&&h[n.weapons[1]].name==D[t].name?"Equipped":"Equip":"Buy ("+D[t].cost[0]+" AG, "+D[t].cost[1]+" PT)"}</div>
    </div>
    `;document.getElementById("contentTurret").innerHTML="";for(let o=0;o<j.length;o++)document.getElementById("contentTurret").innerHTML+=`
    <div class="stopItem">
    <h3>${j[o].name}</h3>
    <div style="font-size: 15px;">${j[o].desc}<br>
    Costs: ${j[o].onplace.money} AG, ${j[o].onplace.wood} Wood, ${j[o].onplace.stone} Stone to place</div>
    <div class = "shopButton"onclick = "manageItems('slot3', '${j[o].name}')">${z[j[o].name]?y[n.items[2]].name==j[o].name?"Equipped":"Equip":"Buy ("+j[o].cost[0]+" AG, "+j[o].cost[1]+" PT)"}</div>
    </div>
    `;document.getElementById("contentWall").innerHTML="";for(let a=0;a<K.length;a++)document.getElementById("contentWall").innerHTML+=`
    <div class="stopItem">
    <h3>${K[a].name}</h3>
    <div style="font-size: 15px;">${K[a].desc}<br>
    Costs: ${K[a].onplace.money} AG, ${K[a].onplace.wood} Wood, ${K[a].onplace.stone} Stone to place</div>
    <div class = "shopButton" onclick = "manageItems('slot1', '${K[a].name}')">${z[K[a].name]?y[n.items[0]].name==K[a].name?"Equipped":"Equip":"Buy ("+K[a].cost[0]+" AG, "+K[a].cost[1]+" PT)"}</div>
    </div>
    `;document.getElementById("contentSpike").innerHTML="";for(let l=0;l<U.length;l++)document.getElementById("contentSpike").innerHTML+=`
    <div class="stopItem">
    <h3>${U[l].name}</h3>
    <div style="font-size: 15px;">${U[l].desc}<br>
    Costs: ${U[l].onplace.AG} AG, ${U[l].onplace.wood} Wood, ${U[l].onplace.stone} Stone to place</div>
    <div class = "shopButton" onclick = "manageItems('slot2', '${U[l].name}')">${z[U[l].name]?y[n.items[1]].name==U[l].name?"Equipped":"Equip":"Buy ("+U[l].cost[0]+" AG, "+U[l].cost[1]+" PT)"}</div>
    </div>
    `;document.getElementById("contentHealing").innerHTML="";for(let s=0;s<Z.length;s++)document.getElementById("contentHealing").innerHTML+=`
    <div class="stopItem">
    <h3>${Z[s].name}</h3>
    <div style="font-size: 15px;">${Z[s].desc}<br>
    Uses: ${Z[s].onheal} Food</div>
    <div class = "shopButton" onclick = "manageItems('healtype', '${Z[s].name}')">${z[Z[s].name]?m[n.healType].name==Z[s].name?"Equipped":"Equip":"Buy ("+Z[s].cost[0]+" AG, "+Z[s].cost[1]+" PT)"}</div>
    </div>
    `;document.getElementById("contentHats").innerHTML="";for(let i=0;i<ee.length;i++)document.getElementById("contentHats").innerHTML+=`
      <div class="stopItem">
      <h3>${ee[i].name}</h3>
      <div style="font-size: 15px;">${ee[i].desc}<br>
      </div>
      <div class = "shopButton" onclick = "manageItems('hat', '${ee[i].name}')">${z[ee[i].name]?n.hatIndex>-1&&p[n.hatIndex].name==ee[i].name?"Equipped":"Equip":"Buy ("+ee[i].cost[0]+" AG, "+ee[i].cost[1]+" PT)"}</div>
      </div>
      `;document.getElementById("contentMake").innerHTML="";for(let $=0;$<J.length;$++)document.getElementById("contentMake").innerHTML+=`
      <div class="stopItem">
      <h3>${J[$].name}</h3>
      <div style="font-size: 15px;">${J[$].desc}<br>
      Costs: ${J[$].onplace.money} AG, ${J[$].onplace.wood} Wood, ${J[$].onplace.stone} Stone to place</div>
      <div class = "shopButton" onclick = "manageItems('slot4', '${J[$].name}')">${z[J[$].name]?n.items[3]&&y[n.items[3]].name==J[$].name?"Equipped":"Equip":"Buy ("+J[$].cost[0]+" AG, "+J[$].cost[1]+" PT)"}</div>
      </div>
      `}window.manageItems=function(e,t){if("primary"==e){for(let o=0;o<h.length;o++)if(h[o].name==t){if(z[t]){T(["equip",[o,"weapon","primary",h[o]]]),en();break}if(n.resource.money-h[o].cost[0]>=0&&n.resource.platinum-h[o].cost[1]>=0){z[t]=!0,T(["buy",[h[o]]]),en();break}}}else if("secondary"==e){for(let a=0;a<h.length;a++)if(h[a].name==t){if(z[t]){T(["equip",[a,"weapon","secondary",h[a]]]),en();break}if(n.resource.money-h[a].cost[0]>=0&&n.resource.platinum-h[a].cost[1]>=0){T(["buy",[h[a]]]),z[t]=!0,en();break}}}else if("slot3"==e){for(let l=0;l<y.length;l++)if(y[l].name==t){if(z[t]){T(["equip",[l,"placement","turret"]]),en();break}if(n.resource.money-y[l].cost[0]>=0&&n.resource.platinum-y[l].cost[1]>=0){z[t]=!0,T(["buy",[y[l]]]),en();break}}}else if("slot2"==e){for(let s=0;s<y.length;s++)if(y[s].name==t){if(z[t]){T(["equip",[s,"placement","spike"]]),en();break}if(n.resource.money-y[s].cost[0]>=0&&n.resource.platinum-y[s].cost[1]>=0){z[t]=!0,T(["buy",[y[s]]]),en();break}}}else if("slot1"==e){for(let i=0;i<y.length;i++)if(y[i].name==t){if(z[t]){T(["equip",[i,"placement","wall"]]),en();break}if(n.resource.money-y[i].cost[0]>=0&&n.resource.platinum-y[i].cost[1]>=0){z[t]=!0,T(["buy",[y[i]]]),en();break}}}else if("healtype"==e){for(let $=0;$<m.length;$++)if(m[$].name==t){if(z[t]){T(["equip",[$,"healtype"]]),en();break}if(n.resource.money-m[$].cost[0]>=0&&n.resource.platinum-m[$].cost[1]>=0){z[t]=!0,en(),T(["buy",[m[$]]]);break}}}else if("hat"==e){for(let d=0;d<p.length;d++)if(p[d].name==t){if(z[t]){T(["equip",[d,"hats",p[d]]]),en();break}if(n.resource.money-p[d].cost[0]>=0&&n.resource.platinum-p[d].cost[1]>=0){z[t]=!0,T(["buy",[p[d]]]),en();break}}}else if("slot4"==e){for(let c=0;c<y.length;c++)if(y[c].name==t){if(z[t]){T(["equip",[c,"placement","maker"]]),en();break}if(n.resource.money-y[c].cost[0]>=0&&n.resource.platinum-y[c].cost[1]>=0){z[t]=!0,T(["buy",[y[c]]]),en();break}}}}}();
